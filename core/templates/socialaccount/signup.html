{% extends "base.html" %}
{% load static tz widget_tweaks i18n socialaccount %}
{% block title %}Registro con Google · Ca’Bigote{% endblock %}

{% block content %}
{% localtime on %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10 col-lg-8">

      <div class="card card-glass shadow-sm">
        <div class="card-header gradiente-header text-center">
          <h1 class="h5 fw-bold mb-0 text-ink">
            <i class="fab fa-google text-gold me-2" aria-hidden="true"></i>
            {% trans "Completa tu registro" %}
          </h1>
        </div>

        {# ---------- FORM DEL SOCIAL SIGNUP ---------- #}
        {% url "socialaccount_signup" as action_url %}
        <form method="post" action="{{ action_url }}" class="needs-validation animate-on-load form-dark" novalidate>
          {% csrf_token %}

          {% if form.errors %}
            <div class="alert alert-danger mb-4" role="alert">
              <ul class="mb-0">
                {% for field in form %}
                  {% for error in field.errors %}
                    <li>{{ error }}</li>
                  {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                  <li>{{ error }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          {# Campos visibles (allauth) #}
          {% for field in form.visible_fields %}
            <div class="mb-3">
              <label for="{{ field.id_for_label }}" class="form-label text-ink">{{ field.label }}</label>
              {# Añadimos estilo dark y tamaño grande #}
              {{ field|add_class:"form-control-dark form-control form-control-lg" }}
              {% if field.help_text %}
                <div class="form-text text-ink-muted small">{{ field.help_text|safe }}</div>
              {% endif %}
              {% for err in field.errors %}
                <div class="invalid-feedback d-block">{{ err }}</div>
              {% endfor %}
            </div>
          {% endfor %}

          {{ redirect_field }}

          <button type="submit" class="btn btn-gold btn-lg w-100 mt-2">
            <i class="fas fa-check me-2" aria-hidden="true"></i> {% trans "Registrarme" %}
          </button>

          <p class="small text-ink-muted mt-3 mb-0 text-center">
            {% trans "Al continuar aceptas nuestra" %} 
            <a href="{% url 'home' %}privacidad" class="footer-link">{% trans "Política de privacidad" %}</a>
            {% trans "y la" %}
            <a href="https://policies.google.com/privacy?hl=es" target="_blank" rel="noopener" class="footer-link">{% trans "Política de Google" %}</a>.
          </p>
        </form>
      </div>

      <div class="card card-glass border-0 text-center mt-3 p-3 shadow-sm">
        <p class="mb-2 text-ink-muted">{% trans "¿Ya tienes cuenta?" %}</p>
        <a href="{% url 'users:login' %}" class="btn btn-outline-gold btn-sm w-100 w-sm-auto mx-auto">
          <i class="fas fa-sign-in-alt me-1" aria-hidden="true"></i> {% trans "Iniciar Sesión" %}
        </a>
      </div>

    </div>
  </div>
</div>
{% endlocaltime %}
{% endblock %}
