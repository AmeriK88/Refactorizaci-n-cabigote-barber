{% extends 'base.html' %}

{% block title %}{{ producto.titulo }} · Productos · Ca’Bigote{% endblock %}

{% block content %}
<div class="container py-5">

  <!-- Header -->
  <div class="card card-glass shadow-sm mb-4 animate-on-load" style="--a-delay:0ms">
    <div class="card-header gradiente-header text-center">
      <h1 class="h4 fw-bold mb-0 text-ink">
        <i class="fas fa-shopping-bag me-2 text-gold" aria-hidden="true"></i>
        {{ producto.titulo }}
      </h1>
    </div>
  </div>

  <div class="row g-4 align-items-start animate-on-load" style="--a-delay:80ms">
    <!-- Galería -->
    <div class="col-12 col-lg-6 animate-on-load" style="--a-delay:120ms">
      <div class="card card-glass product-hero overflow-hidden">
        <div class="product-media">
          {% if producto.imagen %}
            <img
              src="{{ producto.imagen.url }}"
              alt="{{ producto.titulo }}"
              class="w-100 h-100 product-img"
              loading="lazy">
          {% else %}
            <div class="d-flex align-items-center justify-content-center product-img"
                 style="aspect-ratio: 4/3;">
              <span class="text-ink-muted">Sin imagen disponible</span>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Info -->
    <div class="col-12 col-lg-6 animate-on-load" style="--a-delay:200ms">
      <div class="card card-glass h-100">
        <div class="card-body">
          <h2 class="h5 text-ink mb-3">{{ producto.titulo }}</h2>

          {% if producto.precio %}
          <div class="d-flex align-items-center gap-2 mb-3">
            <span class="price-badge">€{{ producto.precio }}</span>
            <span class="availability-pill available">
              <i class="bi bi-check2-circle me-1"></i> Disponible
            </span>
          </div>
          {% else %}
          <div class="mb-3">
            <span class="availability-pill neutral">
              <i class="bi bi-info-circle me-1"></i> Consulta en tienda
            </span>
          </div>
          {% endif %}

          {% if producto.descripcion %}
            <p class="text-ink-muted mb-4">{{ producto.descripcion }}</p>
          {% endif %}

          <div class="d-flex flex-wrap gap-2">
            <a href="https://wa.me/+34659809165?text=Hola%20Ca'Bigote%2C%20quiero%20información%20sobre%20{{ producto.titulo|urlencode }}"
               class="btn btn-gold"
               aria-label="Preguntar por WhatsApp sobre {{ producto.titulo }}">
              <i class="fab fa-whatsapp me-2" aria-hidden="true"></i> Preguntar por WhatsApp
            </a>
            <a href="{% url 'products:ver_imagenes' %}" class="btn btn-outline-gold">
              Volver a productos
            </a>
          </div>

          <!-- Info secundaria -->
          <hr class="footer-sep my-4">
          <ul class="list-unstyled small text-ink-muted m-0">
            <li class="mb-1"><i class="bi bi-shield-check me-2"></i> Calidad profesional de barbería</li>
            <li class="mb-1"><i class="bi bi-box-seam me-2"></i> Recogida en tienda</li>
            <li class="mb-1"><i class="bi bi-geo-alt me-2"></i> C. el Rafael, 43 · Arrecife</li>
          </ul>

        </div>
      </div>
    </div>
  </div>

  <!-- Relacionados (opcional si pasas contexto relacionados) -->
  {% if relacionados %}
  <div class="mt-5">
    <div class="card card-glass shadow-sm mb-3 animate-on-load" style="--a-delay:240ms">
      <div class="card-header gradiente-header text-center">
        <h3 class="h6 fw-bold m-0 text-ink">
          <i class="bi bi-stars me-2" aria-hidden="true"></i> También te puede interesar
        </h3>
      </div>
    </div>

    <div class="row g-4 animate-on-load" style="--a-delay:280ms">
      {% for item in relacionados %}
      <div class="col-12 col-sm-6 col-lg-4 animate-on-load"
           style="--a-delay:{% widthratio forloop.counter0 1 80 %}ms">
        <div class="card card-glass product-card h-100">
          <a href="{% url 'products:detalle_producto' producto_id=item.id %}"
             class="product-thumb d-block"
             aria-label="Ver {{ item.titulo }}">
            {% if item.imagen %}
              <img src="{{ item.imagen.url }}" alt="{{ item.titulo }}" class="w-100 h-100" loading="lazy">
            {% else %}
              <div class="d-flex align-items-center justify-content-center" style="aspect-ratio: 4/3;">
                <span class="text-ink-muted small">Sin imagen</span>
              </div>
            {% endif %}
          </a>
          <div class="card-body text-center">
            <p class="m-0 text-ink"><strong>{{ item.titulo }}</strong></p>
            {% if item.precio %}<small class="text-ink-muted">€{{ item.precio }}</small>{% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

</div>
{% endblock %}
